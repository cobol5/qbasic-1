'                         CARD GAMES....BY KEDJIKEEN
'                                       (Eric Davidson)
'
'       Requirements:
' 1. Unlike several other Kedjikeen productions, this program doesn't have
'       a wacky lot of data files.  (Break'n Out players, you know what I
'       mean)
' 2. This program needs to be run in the same directory as the (few!) data
'       files:
'               1) JOKER                2) SPADE
'               3) HEART                4) DIAMOND
'               5) TOP                  6) CLUB    
' 3. I have never had any problems with memory, so you shouldn't either.
' 4. After one programing class, I >>HATE<< rems, so you probably won't see
'       many, mabey a few.
' 5. Abiltity to run screen 13 graphics
' 6. No install procedures to mess with....COOL!
'
'       Notes from the programer:
' I love...
'       MAVERICK programs (Mike Hulme, Sphere Fighter was excelent!!!)
'       Any sound blaster tutorials, I don't know how SB works
'       Duke Nukem 3-D
'       Comments of any kind, really, any kind
'
' For all those people who don't understand the "Burn a card (y/n)"...
'       If you don't care, just press "Y"
'       It is the way they play in several cassinos
'       The card you press "Y" for will never show up in the game
DECLARE SUB DISCARDS (ROTATE)                     'puts a card in the discard
DECLARE SUB CARDER ()                             'a sub of rank
DECLARE SUB RANK ()                               'determines score in poker
DECLARE SUB DRAWS ()                              'draws a card
DECLARE SUB DEAL (CARD, XH, YV)                   'puts a card on the screen
DECLARE SUB PURGE ()                              'gets rid of jokers
DECLARE SUB SHUFFLE (ROTATE)                      'shuffles the cards
DECLARE SUB SPHERE (SX, SY, SCOLOR, SDIM, SRANGE) 'draws those little balls
DECLARE SUB SPRINT (SMT$, HORIZA, VERTICA, COLO)  'prints that small text
DIM SHARED SMALLTEXT(39, 21)
OPEN "SMALL.TXT" FOR INPUT AS #1
FOR SMT1 = 1 TO 39
FOR SMT2 = 1 TO 21
INPUT #1, SMALLTEXT(SMT1, SMT2)
NEXT SMT2
NEXT SMT1
CLOSE
SCREEN 13
PALETTE 5, 0
COLOR 5
LOCATE 1, 1
PRINT "K  E  D  J  I  K  E  E  N"
C = 63 * .4
FOR B = 63 TO 1 STEP -1
PALETTE B + 120, 65536 * (64 - B)
PALETTE B + 50, 64 - B
C = C - .5
CIRCLE (40 + C, 40 + C), B, B + 50
PAINT (40 + C, 40 + C), B + 50
CIRCLE (230 + C, 40 + C), B, B + 120
PAINT (230 + C, 40 + C), B + 120
NEXT B
FOR A = 0 TO 200
FOR B = 0 TO 8
IF POINT(A, B) = 5 THEN
PSET (A + 56, B + 59), 18 + (B * 2)
END IF
NEXT B
NEXT A
LINE (56, 69)-(255, 70), 32, B
PALETTE 230, (65536 * 35) + (256 * 35)
SPRINT "-STRATEGY-         -ACTION-         -ADVENTURE-", 74, 72, 230
GOSUB 2
CLEAR
SCREEN 9
SCREEN 13
PALETTE 233, 65536 * 50 + 50
PALETTE 232, 63
LOCATE 10, 11
KLLEM = 0
PALETTE 178, 65536 * 61
COLOR 232
PRINT "Loading, please wait"
OPEN "CARD.STS" FOR APPEND AS #3
WRITE #3, 0, 0, 0, 0, 3, 0
CLOSE
OPEN "CARD.STS" FOR INPUT AS #3
INPUT #3, Z1, Z2, Z3, Z4, Z5, Z6
CLOSE
OPEN "CARD.STS" FOR OUTPUT AS #4
WRITE #4, Z1, Z2, Z3, Z4, Z5, Z6
CLOSE
DIM RANKS$(9)
RANKS$(0) = "NOTHING"
RANKS$(1) = "ONE PAIR"
RANKS$(2) = "TWO PAIR"
RANKS$(3) = "THREE OF A KIND"
RANKS$(4) = "FLUSH"
RANKS$(5) = "STRAIGHT"
RANKS$(6) = "FULL HOUSE"
RANKS$(7) = "FOUR OF A KIND"
RANKS$(8) = "STRAIGHT FLUSH"
RANKS$(9) = "ROYAL FLUSH"
DIM ME(22)
DIM HE(22)
DIM SHARED MY(5)
DIM SHARED COMP(5, 7)
DIM SHARED HANDS(5)
DIM SHARED HAND(5)
DIM SHARED DECK(54)
DIM SHARED P1(28)
DIM SHARED P2(28)
DIM SHARED DISCARD(54)
LINE (109, 89)-(214, 96), 233, B
GOSUB KLLEM
FOR LP = 1 TO 119
IF LP = 15 OR LP = 30 OR LP = 45 OR LP = 60 OR LP = 75 OR LP = 90 OR LP = 105 THEN GOSUB KLLEM
PALETTE LP, 0
NEXT LP
GOSUB KLLEM
OPEN "SMALL.TXT" FOR INPUT AS #1
FOR SMT1 = 1 TO 39
FOR SMT2 = 1 TO 21
INPUT #1, SMALLTEXT(SMT1, SMT2)
NEXT SMT2
NEXT SMT1
CLOSE
GOSUB KLLEM
DIM SHARED JOKER(22, 24)
DIM SHARED HEART(22, 24)
DIM SHARED CLUB(22, 24)
DIM SHARED SPADE(22, 24)
DIM SHARED DIME(22, 24)
DIM SHARED TOP(22, 24)
DIM SHARED CARD(1)
DIM SHARED HANDE(5)
OPEN "TOP" FOR INPUT AS #1
FOR B = 1 TO 22
FOR C = 1 TO 24
INPUT #1, G
PSET (B, C), G
NEXT C
NEXT B
CLOSE
GET (1, 1)-(22, 24), TOP
OPEN "HEART" FOR INPUT AS #1
FOR B = 1 TO 22
FOR C = 1 TO 24
INPUT #1, G
PSET (B, C), G
NEXT C
NEXT B
CLOSE
GET (1, 1)-(22, 24), HEART
GOSUB KLLEM
OPEN "DIAMOND" FOR INPUT AS #1
FOR B = 1 TO 22
FOR C = 1 TO 24
INPUT #1, G
PSET (B, C), G
NEXT C
NEXT B
CLOSE
GET (1, 1)-(22, 24), DIME
GOSUB KLLEM
OPEN "CLUB" FOR INPUT AS #1
FOR B = 1 TO 22
FOR C = 1 TO 24
INPUT #1, G
PSET (B, C), G
NEXT C
NEXT B
CLOSE
GET (1, 1)-(22, 24), CLUB
GOSUB KLLEM
OPEN "SPADE" FOR INPUT AS #1
FOR B = 1 TO 22
FOR C = 1 TO 24
INPUT #1, G
PSET (B, C), G
NEXT C
NEXT B
CLOSE
GET (1, 1)-(22, 24), SPADE
GOSUB KLLEM
OPEN "JOKER" FOR INPUT AS #1
FOR B = 1 TO 22
FOR C = 1 TO 24
INPUT #1, G
PSET (B, C), G
NEXT C
NEXT B
CLOSE
GET (1, 1)-(22, 24), JOKER
GOSUB KLLEM
DIM BALL(18, 18)
HOME:
SHUFFLE 1
SCREEN 7
SCREEN 13
SPHERE 60, 43, INT(RND(1) * 7) + 1, 12, 200
GET (43, 26)-(77, 60), BALL
T = 1
COLOR 231
PALETTE 231, 256 * 56
LOCATE 3, 15
PRINT "CARD GAMES"
PALETTE 230, 65536 * 50 + 50
SPRINT "BY ERIC DAVIDSON   1996", 133, 27, 230
HOMER:
G = 0
DO UNTIL G <> 0
COLOR 1
IF T = 1 THEN COLOR 4
LOCATE 6, 11
PRINT "1. CLASSIC BLACK JACK"
COLOR 1
IF T = 2 THEN COLOR 4
LOCATE 8, 11
PRINT "2. ERIC'S EIGHTS (NEW!)"
COLOR 1
IF T = 3 THEN COLOR 4
LOCATE 10, 11
PRINT "3. CLASSIC POKER"
COLOR 1
IF T = 4 THEN COLOR 4
LOCATE 12, 11
PRINT "4. OPTIONS WINDOW"
COLOR 1
IF T = 5 THEN COLOR 4
LOCATE 14, 11
PRINT "5. QUIT CARD GAMES"
GOSUB 2
TT = T * 16 + 10
IF K$ = "H" AND T > 1 THEN
FOR TY = TT TO TT - 16 STEP -.2
PUT (43, TY), BALL, PSET
NEXT TY
T = T - 1
END IF
IF K$ = "P" AND T < 5 THEN
FOR TY = TT TO TT + 16 STEP .2
PUT (43, TY), BALL, PSET
NEXT TY
T = T + 1
END IF
IF K$ = CHR$(13) THEN G = T
IF K$ = "1" THEN G = 1
IF K$ = "2" THEN G = 2
IF K$ = "3" THEN G = 3
IF K$ = "4" THEN G = 4
IF K$ = "5" THEN G = 5
LOOP
IF G = 5 THEN END
IF G = 1 THEN GOTO BLACKJACK
IF G = 3 THEN GOTO POKER
IF G = 4 THEN GOTO REG
IF G = 2 THEN GOTO ETS
END
KLLEM:
LINE (110 + (KLLEM * 7), 90)-(115 + (KLLEM * 7), 95), 178, BF
KLLEM = KLLEM + 1
RETURN
2
K$ = ""
DO UNTIL K$ <> ""
K$ = UCASE$(RIGHT$(INKEY$, 1))
LOOP
RETURN
BLACKJACK:                         'plays Black Jack
SCREEN 9
SCREEN 13
T = 0
G = 1
RANDOMIZE TIMER
PALETTE 251, 65536 * 54
COLOR 249
LOCATE 1, 1
PRINT "BLACK JACK"
FOR A = 0 TO 79
FOR B = 0 TO 8
IF POINT(A, B) = 249 THEN
PSET (A + 100, B + 2), 18 + (B * 2)
END IF
NEXT B
NEXT A
LINE (5, 15)-(160, 100), 251, B
PALETTE 254, 65536 * 32
LINE (6, 101)-(161, 101), 254
LINE (161, 16)-(161, 101), 254
LINE (7, 102)-(162, 102), 254
LINE (162, 17)-(162, 102), 254
PALETTE 252, 57
PALETTE 253, 30
LINE (170, 15)-(230, 32), 252, B
LINE (171, 33)-(231, 33), 253
LINE (231, 16)-(231, 33), 253
LINE (170, 38)-(230, 55), 252, B
LINE (171, 56)-(231, 56), 253
LINE (231, 39)-(231, 56), 253
LINE (170, 61)-(230, 78), 252, B
LINE (171, 79)-(231, 79), 253
LINE (231, 62)-(231, 79), 253
LINE (170, 84)-(230, 101), 252, B
LINE (171, 102)-(231, 102), 253
LINE (231, 85)-(231, 102), 253
PALETTE 255, 256 * 57 + 58
SPRINT "         CASH:", 173, 17, 255
SPRINT "          BET:", 174, 40, 255
SPRINT "   YOUR TOTAL:", 174, 63, 255
SPRINT "        SKILL:", 174, 86, 255
COLOR 4
LOCATE 3, 31
PRINT "H"; : COLOR 35: PRINT "it"
COLOR 4
LOCATE 6, 31
PRINT "S"; : COLOR 35: PRINT "tand"
COLOR 4
LOCATE 9, 31
PRINT "D"; : COLOR 35: PRINT "ouble"
LOCATE 10, 35
PRINT "down"
PALETTE 235, 256 * 60
D$ = "EASY"
SPRINT D$, 174, 93, 235
CASH = 10000
PALETTE 200, 63
BURN:
LINE (6, 16)-(159, 99), 249, BF
DO UNTIL K$ = "Y"
SHUFFLE 2
PURGE
DRAWS
COLOR 35
IF CASH <> 10000 THEN
LOCATE 8, 5
PRINT "OUT OF CARDS,"
END IF
LOCATE 9, 4
PRINT "BURN THIS CARD?"
LOCATE 10, 8
PRINT "(Y / N)"
DEAL CARD(1), 70, 28
GOSUB 2
LINE (6, 16)-(159, 99), 249, BF
LOOP
COLOR 248
PALETTE 248, (65536 * 60) + (256 * 59)
LOCATE 15, 1
PRINT "This is the classic game of BLACK JACK."
PRINT "You are trying to get as close to 21 as"
PRINT "possible without going over.  Face cards"
PRINT "count as 10 and aces count as either 11s"
PRINT "or 1s. <SPACE> controls dificulty. Hit"
PRINT "gives you another card, Stand lets you"
PRINT "keep the cards you have.  Double Down"
PRINT "gives you one more card and doubles the"
PRINT "bet amount. Dealer wins all pushes."
EXT = 0
DO UNTIL EXT = 1
LINE (173, 24)-(198, 31), 249, BF
SPRINT STR$(CASH), 173, 24, 235
BET = 0
DO UNTIL BET <= CASH AND BET > 0
COLOR 251
LOCATE 7, 5
PRINT "YOUR BET:"
LOCATE 8, 5
PRINT "          "
LOCATE 8, 5
INPUT "", BET$
BET = VAL(BET$)
BET = INT(BET)
LINE (6, 16)-(159, 99), 249, BF
LOOP
SPRINT STR$(BET), 174, 47, 235
A1 = 0
A2 = 0
T1 = 0
C1 = 2
C2 = 2
T2 = 0
DRAWS
IF CARD(1) = 0 THEN GOTO BURN
P1(1) = CARD(1)
T = INT(P1(1))
IF T > 10 THEN T = 10
T1 = T1 + T
IF INT(P1(1)) = 1 THEN T1 = 10 + T1: A1 = 10
DRAWS
IF CARD(1) = 0 THEN GOTO BURN
P2(1) = CARD(1)
T = INT(P2(1))
IF T > 10 THEN T = 10
T2 = T2 + T
IF INT(P2(1)) = 1 THEN T2 = 10 + T2: A2 = 10
DRAWS
IF CARD(1) = 0 THEN GOTO BURN
P1(2) = CARD(1)
T = INT(P1(2))
IF T > 10 THEN T = 10
T1 = T1 + T
IF INT(P1(2)) = 1 THEN T1 = 10 + T1: A1 = A1 + 10
DRAWS
IF CARD(1) = 0 THEN GOTO BURN
P2(2) = CARD(1)
T = INT(P2(2))
IF T > 10 THEN T = 10
T2 = T2 + T
IF INT(P2(2)) = 1 THEN T2 = 10 + T2: A2 = A2 + 10
DEAL P1(1), 15, 70
DEAL P1(2), 40, 70
DEAL 0, 15, 20
DEAL P2(2), 40, 20
IF T1 > 21 AND A1 > 0 THEN T1 = T1 - 10: A1 = A1 - 10
LINE (174, 70)-(189, 76), 249, BF
SPRINT STR$(T1), 174, 70, 235
IF T1 = 21 THEN GOTO BJ
IF T2 = 21 THEN GOTO BJ
KEYS:
GOSUB 2
IF K$ = " " THEN
IF D$ = "EASY" THEN
D$ = "HARD"
ELSE
D$ = "EASY"
END IF
LINE (174, 93)-(189, 99), 249, BF
SPRINT D$, 174, 93, 235
END IF
IF K$ = "Q" THEN EXT = 1: GOTO WATE
IF K$ = "H" AND C1 < 5 THEN
C1 = C1 + 1
DRAWS
IF CARD(1) = 0 THEN GOTO BURN
P1(C1) = CARD(1)
T = INT(P1(C1))
IF T > 10 THEN T = 10
T1 = T1 + T
IF INT(P1(C1)) = 1 THEN T1 = T1 + 10: A1 = A1 + 10
IF T1 > 21 AND A1 > 0 THEN T1 = T1 - 10: A1 = A1 - 10
DEAL P1(C1), (C1 * 25) - 10, 70
END IF
IF K$ = "D" AND C1 < 5 THEN
C1 = C1 + 1
DRAWS
IF CARD(1) = 0 THEN GOTO BURN
P1(C1) = CARD(1)
T = INT(P1(C1))
IF T > 10 THEN T = 10
T1 = T1 + T
IF INT(P1(C1)) = 1 THEN T1 = T1 + 10: A1 = A1 + 10
IF T1 > 21 AND A1 > 0 THEN T1 = T1 - 10: A1 = A1 - 10
DEAL P1(C1), (C1 * 25) - 10, 70
BET = BET * 2
LINE (174, 47)-(198, 53), 249, BF
SPRINT STR$(BET), 174, 47, 235
GOTO COMBJ
END IF
IF T1 > 21 THEN GOTO BJ
IF K$ = "S" THEN GOTO COMBJ
LINE (174, 70)-(189, 76), 249, BF
SPRINT STR$(T1), 174, 70, 235
GOTO KEYS
COMBJ:
DEAL P2(1), 15, 20
GOAL = T1
IF D$ = "EASY" THEN GOAL = 17
DO UNTIL T2 >= GOAL OR C2 = 5
C2 = C2 + 1
DRAWS
IF CARD(1) = 0 THEN GOTO BURN
P2(C2) = CARD(1)
T = INT(P2(C2))
IF T > 10 THEN T = 10
T2 = T2 + T
IF INT(P2(C2)) = 1 THEN T2 = T2 + 10: A2 = A2 + 10
IF T2 > 21 AND A2 > 0 THEN T2 = T2 - 10: A2 = A2 - 10
DEAL P2(C2), (C2 * 25) - 10, 20
LOOP
BJ:
LINE (174, 70)-(189, 76), 249, BF
SPRINT STR$(T1), 174, 70, 235
CH = CASH
IF T1 = 21 AND C1 = 2 THEN H$ = "BLACK JACK!": CASH = CASH + (BET * 2): GOTO DR
IF T2 = 21 AND C2 = 2 THEN H$ = "DEALER BLACK JACK": CASH = CASH - (BET * 2): GOTO DR
IF T1 > 21 THEN CASH = CASH - BET: H$ = "YOU BUST": GOTO DR
IF T2 > 21 THEN CASH = CASH + BET: H$ = "DEALER BUST": GOTO DR
IF T1 = T2 THEN CASH = CASH - BET: H$ = "PUSH": GOTO DR
IF T1 > T2 THEN CASH = CASH + BET: H$ = "YOU WIN"
IF T2 > T1 THEN CASH = CASH - BET: H$ = "YOU LOSE"
DR:
IF CASH > CH THEN
PLAY "O3L40GGBC"
ELSE
PLAY "O0L3G"
END IF
COLOR 200
LOCATE 8, 3
PRINT H$
WATE:
GOSUB 2
IF K$ = "Q" THEN EXT = 1
LINE (174, 47)-(198, 53), 249, BF
LINE (6, 16)-(159, 99), 249, BF
IF CASH < 1 THEN
LOCATE 8, 6
COLOR 200
PRINT "GAME OVER!"
EXT = 1
GOSUB 2
END IF
IF Z6 = 1 THEN SHUFFLE 2: PURGE
LOOP
CASH = CASH - 10000
Z1 = Z1 + 1
Z3 = Z3 + CASH
OPEN "CARD.STS" FOR OUTPUT AS #3
WRITE #3, Z1, Z2, Z3, Z4, Z5, Z6
CLOSE
GOTO HOME
REG:
FOR G = 1 TO 7
H = G * 2 + 16
LINE (75 + G, 45 + G)-(225 - G, 135 - G), H, B
NEXT G
LINE (83, 53)-(217, 127), 249, BF
LINE (83, 53)-(217, 127), 27, B
PALETTE 90, (60 * 256) + (65536 * 60)
G$ = "OPTIONS SCREEN"
SPRINT G$, 118, 57, 90
TT = 1
G = 0
PALETTE 91, 55
PALETTE 92, 65536 * 50
PALETTE 93, 65536 * 50
PALETTE 94, 65536 * 50
PALETTE 95, 65536 * 50
IF Z6 = 0 THEN YY$ = "ON"
IF Z6 = 1 THEN YY$ = "OFF"
SPRINT "1. VIEW STATISTIC SCREEN", 90, 77, 91
SPRINT "2. CLEAR STATISTIC SCREEN", 90, 87, 92
SPRINT "3. TURN AUTO SHUFFLING " + YY$, 90, 97, 93
SPRINT "4. SELECT DIFICULTY-POKER", 90, 107, 94
SPRINT "5. QUIT OPTIONS SCREEN", 90, 117, 95
DO UNTIL G > 0
PALETTE 90 + TT, 55
GOSUB 2
IF K$ = "H" AND TT > 1 THEN PALETTE 90 + TT, 65536 * 50: TT = TT - 1
IF K$ = "P" AND TT < 5 THEN PALETTE 90 + TT, 65536 * 50: TT = TT + 1
IF K$ = CHR$(13) THEN G = TT
IF K$ = "1" THEN G = 1
IF K$ = "2" THEN G = 2
IF K$ = "3" THEN G = 3
IF K$ = "4" THEN G = 4
IF K$ = "5" THEN G = 5
LOOP
IF G = 3 THEN
IF Z6 = 0 THEN
Z6 = 1
ELSE
Z6 = 0
END IF
OPEN "CARD.STS" FOR OUTPUT AS #3
WRITE #3, Z1, Z2, Z3, Z4, Z5, Z6
CLOSE
END IF
IF G = 2 THEN
OPEN "CARD.STS" FOR OUTPUT AS #3
WRITE #3, 0, 0, 0, 0, 3, 0
CLOSE
Z1 = 0
Z2 = 0
Z3 = 0
Z4 = 0
Z5 = 3
Z6 = 0
G = 1
END IF
IF G = 4 THEN
H = 0
LINE (84, 54)-(216, 126), 249, BF             'selects difficulty
SPRINT "1. ALWAYS WIN", 90, 57, 94
SPRINT "2. VERY EASY", 90, 67, 94
SPRINT "3. MEDIUM-EASY", 90, 77, 94
SPRINT "4. REALITY", 90, 87, 94
SPRINT "5. HARD", 90, 97, 94
SPRINT "6. DIFFICULT", 90, 107, 94
SPRINT "7. CRAZY", 90, 117, 94
DO UNTIL H < 8 AND H > 0
GOSUB 2
H = VAL(K$)
H = INT(H)
LOOP
Z5 = H
OPEN "CARD.STS" FOR OUTPUT AS #3
WRITE #3, Z1, Z2, Z3, Z4, Z5, Z6
CLOSE
END IF
IF G = 1 THEN
LINE (84, 54)-(216, 126), 249, BF
PALETTE 91, 60
PALETTE 90, 65536 * 60
SPRINT "BLACK JACK GAMES PLAYED", 90, 57, 91
SPRINT STR$(Z1), 99, 65, 90
SPRINT "POKER GAMES PLAYED", 90, 75, 91
SPRINT STR$(Z2), 99, 83, 90
SPRINT "MONEY WON-BLACKJACK", 90, 93, 91
SPRINT STR$(Z3), 99, 101, 90
SPRINT "MONEY WON-POKER", 90, 111, 91
SPRINT STR$(Z4), 99, 119, 90
GOSUB 2
END IF
LINE (75, 40)-(225, 137), 249, BF
GOTO HOMER
POKER:                                'plays Poker
SCREEN 7
SCREEN 13
T = 0
G = 1
RANDOMIZE TIMER
PALETTE 251, 65536 * 54
COLOR 249
LOCATE 1, 1
PRINT "POKER"
FOR A = 0 TO 59
FOR B = 0 TO 8
IF POINT(A, B) = 249 THEN
PSET (A + 111, B + 2), 18 + (B * 2)
END IF
NEXT B
NEXT A
LINE (5, 15)-(160, 100), 251, B
PALETTE 254, 65536 * 32
LINE (6, 101)-(161, 101), 254
LINE (161, 16)-(161, 101), 254
LINE (7, 102)-(162, 102), 254
LINE (162, 17)-(162, 102), 254
PALETTE 252, 57
PALETTE 253, 30
LINE (170, 15)-(235, 32), 252, B
LINE (171, 33)-(236, 33), 253
LINE (236, 16)-(236, 33), 253
LINE (170, 38)-(235, 55), 252, B
LINE (171, 56)-(236, 56), 253
LINE (236, 39)-(236, 56), 253
LINE (170, 61)-(235, 78), 252, B
LINE (171, 79)-(236, 79), 253
LINE (236, 62)-(236, 79), 253
LINE (170, 84)-(235, 101), 252, B
LINE (171, 102)-(236, 102), 253
LINE (236, 85)-(236, 102), 253
PALETTE 255, 256 * 57 + 58
SPRINT "         CASH:", 175, 17, 255
SPRINT "          BET:", 176, 40, 255
SPRINT "    YOUR HAND:", 176, 63, 255
SPRINT "        SKILL:", 176, 86, 255
COLOR 248
PALETTE 248, (65536 * 60) + (256 * 59)
LOCATE 15, 1
PRINT "This is classic style POKER. You can use"
PRINT "jokers and dificulty is specified in the"
PRINT "options window.  You can return up to 3"
PRINT "cards <SPACE>. Ante is $10.  Skill:"
PRINT "1-easy  3-realistic  5-hard  7-crazy."
PRINT "You can raise when your cards are given"
PRINT "to you and just before you lay down"
PRINT "your hand. Press ENTER to fold.  Q to"
PRINT "quit poker."
PALETTE 45, 60
COLOR 35
LOCATE 3, 31
PRINT "1 pair"
COLOR 45
LOCATE 4, 31
PRINT "2 pair"
COLOR 35
LOCATE 5, 31
PRINT "3 of kind"
COLOR 45
LOCATE 6, 31
PRINT "flush"
COLOR 35
LOCATE 7, 31
PRINT "straight"
COLOR 45
LOCATE 8, 31
PRINT "full house"
COLOR 35
LOCATE 9, 31
PRINT "4 of kind"
COLOR 45
LOCATE 10, 31
PRINT "straight"
LOCATE 11, 35
PRINT "flush"
COLOR 35
LOCATE 12, 31
PRINT "Royal"
LOCATE 13, 35
PRINT "flush"
CASH = 10000
EXT = 0
SKILL = Z5
PALETTE 235, 256 * 56
PALETTE 234, (65536 * 20) + (256 * 60) + 40
DO UNTIL EXT = 1
BET = 10
SHUFFLE 2
LINE (6, 16)-(159, 99), 249, BF
LINE (173, 23)-(234, 31), 249, BF
LINE (173, 46)-(234, 54), 249, BF
LINE (173, 69)-(234, 77), 249, BF
SPRINT STR$(BET), 175, 48, 235
SPRINT STR$(CASH), 175, 25, 235
SPRINT STR$(SKILL), 175, 93, 235
JOK = 0
FOR A = 1 TO 5
DRAWS
IF CARD(1) = 50 AND JOK = 1 THEN DRAWS
IF CARD(1) = 50 THEN JOK = 1
MY(A) = CARD(1)
HAND(A) = MY(A)
NEXT A
FOR A = 1 TO 5
DEAL MY(A), (A * 26) - 10, 70
NEXT A
RANK
F$ = RANKS$(CARD(0))
SPRINT F$, 174, 71, 235
COLOR 234
RETRY:
LOCATE 8, 3
PRINT "               "
LOCATE 8, 3
INPUT "BET: ", A$
IF A$ = "CHEAT" THEN
FOR A = 1 TO 5
LOCATE 8, 3
INPUT "H: ", MY(A)
DEAL MY(A), (A * 26) - 10, 70
HAND(A) = MY(A)
NEXT A
END IF
IF A$ = "" THEN GOTO FOLD
BETS = INT(VAL(A$))
IF BETS + BET < 11 OR BETS + BET > CASH - 1 THEN GOTO RETRY
LOCATE 8, 3
PRINT "                "
BET = BETS + BET
LINE (173, 46)-(234, 54), 249, BF
SPRINT STR$(BET), 175, 48, 235
G = 1
T = 0
K$ = ""
DO UNTIL CHR$(13) = K$
LINE (15, 95)-(144, 95), 249
LINE (G * 26 - 10, 95)-(G * 26 + 11, 95), 252
GOSUB 2
IF K$ = " " THEN
T = T + 1
MY(G) = 0
DEAL 0, G * 26 - 10, 70
END IF
IF K$ = "M" AND G < 5 THEN G = G + 1
IF K$ = "K" AND G > 1 THEN G = G - 1
IF T = 3 THEN K$ = CHR$(13)
LOOP
LINE (15, 95)-(144, 95), 249
FOR AB = 1 TO 5
IF MY(AB) = 0 THEN
DRAWS
IF CARD(1) = 50 AND JOK = 1 THEN DRAWS
IF CARD(1) = 50 THEN JOK = 1
MY(AB) = CARD(1)
DEAL MY(AB), AB * 26 - 10, 70
END IF
NEXT AB
FOR G = 1 TO 5
HAND(G) = MY(G)
NEXT G
RANK
F = CARD(0)
LINE (173, 69)-(234, 77), 249, BF
F$ = RANKS$(CARD(0))
SPRINT F$, 174, 71, 235
RTRY:
LOCATE 8, 3
PRINT "               "
LOCATE 8, 3
INPUT "BET: ", A$
IF A$ = "" THEN GOTO FOLD
IF VAL(A$) < 1 THEN GOTO RTRY
BETS = VAL(A$) + BET
IF BETS < 1 + BET OR BETS > CASH THEN GOTO RTRY
BET = BETS
LOCATE 8, 3
PRINT "                "
LINE (173, 46)-(234, 54), 249, BF
SPRINT STR$(BET), 175, 48, 235
BEST = 0
FOR B = 1 TO SKILL
JOK = 0
FOR C = 1 TO 5
DRAWS
IF CARD(1) = 50 AND JOK = 1 THEN DRAWS
IF CARD(1) = 50 THEN JOK = 1
COMP(C, B) = CARD(1)
HAND(C) = COMP(C, B)
NEXT C
RANK
COMP(0, B) = CARD(0)
IF CARD(0) >= BEST THEN
BEST = CARD(0)
BST = B
END IF
NEXT B
FOR A = 1 TO 5
DEAL COMP(A, BST), (A * 26) - 10, 20
NEXT A
F$ = RANKS$(BEST)
SPRINT F$, 100, 48, 235
IF BEST = F THEN
FOR A = 1 TO 5
IF COMP(A, BST) > COMP(1, BST) THEN COMP(1, BST) = COMP(A, BST)
IF MY(A) > MY(1) THEN MY(1) = MY(A)
NEXT A
IF COMP(1, BST) > MY(1) THEN
BEST = BEST + 1
ELSE
BEST = BEST - 1
END IF
END IF
GOTO SKIP
FOLD:
BEST = F + 3
SKIP:
IF BEST > F THEN F$ = "I WIN": CASH = CASH - BET: PLAY "O0L5GC"
IF BEST < F THEN F$ = "YOU WIN": CASH = CASH + BET: PLAY "O3L40GGBC"
LOCATE 8, 3
PRINT "              "
LOCATE 8, 4
COLOR 252
PRINT F$
GOSUB 2
IF K$ = "Q" THEN EXT = 1
IF CASH < 2 THEN EXT = 1
LOOP
CASH = CASH - 10000
Z4 = Z4 + CASH
Z2 = Z2 + 1
OPEN "CARD.STS" FOR OUTPUT AS #3
WRITE #3, Z1, Z2, Z3, Z4, Z5, Z6
CLOSE
GOTO HOME
ETS:
SCREEN 7
SCREEN 13
T = 0
G = 1
RANDOMIZE TIMER
PALETTE 251, 65536 * 54
COLOR 249
LOCATE 1, 1
PRINT "ERIC'S EIGHTS"
FOR A = 0 TO 105
FOR B = 0 TO 8
IF POINT(A, B) = 249 THEN
PSET (A + 105, B + 2), 18 + (B * 2)
END IF
NEXT B
NEXT A
LINE (5, 15)-(290, 100), 251, B
PALETTE 254, 65536 * 32
LINE (6, 101)-(291, 101), 254
LINE (291, 16)-(291, 101), 254
LINE (7, 102)-(292, 102), 254
LINE (292, 17)-(292, 102), 254
COLOR 248
PALETTE 248, (65536 * 60) + (256 * 59)
LOCATE 15, 1
PALETTE 72, 256 * 55
PRINT "This is classic similar to the old game"
PRINT "called CRAZY EIGHTS.  Trust me, you'll"
PRINT "like it. The object of the game is to"
PRINT "get to zero cards before your oponent."
PRINT "You can play on any card with the same"
PRINT "number or same suit.  Aces mean draw 2."
PRINT "An eight is wild, choose your own suit."
PRINT "Jokers are wild/draw 4.  You can play"
PRINT "again on face cards.  Q to quit."
SHUFFLE 5
PALETTE 45, 60
FOR G = 1 TO 8
DRAWS
ME(G) = CARD(1)
DEAL ME(G), G * 12, 70
DRAWS
HE(G) = CARD(1)
NEXT G
NEST:
DRAWS
C = CARD(1)
DISCARDS C
IF C = 50 OR INT(C) = 8 OR INT(C) = 1 THEN GOTO NEST
DEAL C, 240, 25
SPRINT "TOP CARD", 235, 18, 45
SPRINT "YOUR CARD", 142, 18, 45
EXT = 0
ME(0) = 8
HE(0) = 8
DO UNTIL EXT = 1
H = 1
FISH:                          '<--- Sorry, don't have this hame
F = 0
FOR E = 1 TO ME(0)
MD = INT(((ME(E) - INT(ME(E))) * 10) + .5) / 10
MI = INT(ME(E))
CD = INT(((C - INT(C)) * 10) + .5) / 10
CI = INT(C)
IF MD = CD OR MI = CI OR MI = 50 OR MI = 8 THEN F = 1
NEXT E
IF F = 0 THEN
DEAL 0, (ME(0) + 1) * 12, 70
PLAY "O0L40G"
FOR F = 1 TO 1000
NEXT F
DRAWS
ME(0) = ME(0) + 1
ME(ME(0)) = CARD(1)
DEAL ME(ME(0)), ME(0) * 12, 70
GOTO FISH
END IF
KILLER:
LOCATE 5, 5
COLOR 35
PRINT "MY CARDS:" + STR$(HE(0)) + "  "
IF STP = 1 THEN
COLOR 45
LOCATE 3, 3
PRINT "<S>top"
ELSE
LOCATE 3, 3
PRINT "      "
END IF
LINE (8, 95)-(274, 95), 249
IF H < ME(0) THEN
LINE (H * 12, 95)-(H * 12 + 11, 95), 35
ELSE
LINE (H * 12, 95)-(H * 12 + 21, 95), 35
END IF
DEAL ME(H), 140, 25
GOSUB 2
IF K$ = "Q" THEN T$ = "THANKS FOR PLAYING": GOTO ZER
IF K$ = CHR$(13) THEN GOTO DONER
IF K$ = "S" AND STP = 1 THEN GOTO STP
IF K$ = "M" AND H < ME(0) THEN H = H + 1
IF K$ = "K" AND H > 1 THEN H = H - 1
GOTO KILLER
DONER:
MD = INT(((ME(H) - INT(ME(H))) * 10) + .5) / 10
MI = INT(ME(H))
CD = INT(((C - INT(C)) * 10) + .5) / 10
CI = INT(C)
IF MD <> CD AND MI <> CI AND MI <> 8 AND MI <> 50 THEN GOTO KILLER
STP = 0
AD = 0
IF MI = 50 THEN
STP = 1
FOR X = 1 TO 4
DRAWS
HE(0) = HE(0) + 1
HE(HE(0)) = CARD(1)
NEXT X
END IF
IF MI = 1 THEN
STP = 1
DRAWS
HE(0) = HE(0) + 1
HE(HE(0)) = CARD(1)
DRAWS
HE(0) = HE(0) + 1
HE(HE(0)) = CARD(1)
END IF
IF MI = 8 OR MI = 50 THEN
GOSUB SUIT
ME(H) = 8 + AD
END IF
LINE (6, 70)-(289, 99), 249, BF
IF MI > 10 THEN STP = 1
DISCARDS ME(H)
C = ME(H)
DEAL ME(H), 240, 25
ME(H) = ME(H) + AD
IF H < 22 THEN
FOR F = H + 1 TO 22
ME(F - 1) = ME(F)
NEXT F
END IF
ME(0) = ME(0) - 1
ME(22) = 0
IF ME(0) = 0 THEN GOTO ZERO
FOR F = 1 TO ME(0)
DEAL ME(F), F * 12, 70
NEXT F
IF STP = 1 THEN GOTO KILLER
STP:
STP = 0
E = HE(0)
F = 1
DO UNTIL F >= E
IF INT(HE(F)) = 50 OR INT(HE(F)) = 8 THEN
SWAP HE(F), HE(E)
E = E - 1
END IF
F = F + 1
LOOP
KEL = 0
YO:
KEL = 0
FOR H = 1 TO HE(0)
MD = INT(((HE(H) - INT(HE(H))) * 10) + .5) / 10
MI = INT(HE(H))
CD = INT(((C - INT(C)) * 10) + .5) / 10
CI = INT(C)
IF MD = CD OR MI = CI OR MI = 8 OR MI = 50 THEN GOTO YU
NEXT H
IF KEL = 0 THEN
PLAY "O3L30G"
DRAWS
HE(0) = HE(0) + 1
HE(HE(0)) = CARD(1)
GOTO YO
ELSE
GOTO YI
END IF
YU:
IF MI = 50 THEN
FOR G = 1 TO 4
PLAY "O0L40G"
DRAWS
ME(0) = ME(0) + 1
ME(ME(0)) = CARD(1)
DEAL ME(ME(0)), ME(0) * 12, 70
NEXT G
KEL = 1
SLEEP 1
END IF
IF MI = 1 THEN
KEL = 1
FOR G = 1 TO 2
PLAY "O0L40G"
DRAWS
ME(0) = ME(0) + 1
ME(ME(0)) = CARD(1)
DEAL ME(ME(0)), ME(0) * 12, 70
NEXT G
SLEEP 1
END IF
DISCARDS HE(H)
C = HE(H)
DEAL HE(H), 240, 25
IF H < 22 THEN
FOR F = H + 1 TO 22
HE(F - 1) = HE(F)
NEXT F
END IF
HE(0) = HE(0) - 1
HE(22) = 0
IF HE(0) = 0 THEN GOTO ZERO2
IF MI > 10 THEN KEL = 1
IF MI = 50 OR MI = 8 THEN C = HE(1)
IF KEL = 1 THEN GOTO YO
YI:
DISCARDS 4
F = 0
G = 1
DO UNTIL G = 0
F = F + 1
G = DECK(F)
LOOP
FOR G = 1 TO DISCARD(0)
DECK(F + G - 1) = DISCARD(G)
NEXT G
FOR G = 0 TO 54
DISCARD(G) = 0
NEXT G
GOTO LOP
ZERO2:
PLAY "O0L3GC"
T$ = "I WIN!"
GOTO ZER
ZERO:
PLAY "O3L30GGBC"
T$ = "YOU WIN!"
ZER:
EXT = 1
LINE (6, 16)-(279, 99), 249, BF
COLOR 45
LOCATE 5, 5
PRINT T$
GOSUB 2
LOP:
LOOP
GOTO HOME
SUIT:
COLOR 72
LOCATE 4, 3
PRINT "<S>pade <H>eart"                  'choose suit when you play a
LOCATE 3, 3                              'wild card (Joker or 8)
PRINT "<D>imond <C>lub"
K$ = ""
DO UNTIL K$ = "S" OR K$ = "H" OR K$ = "C" OR K$ = "D"
GOSUB 2
LOOP
LOCATE 4, 3
PRINT SPACE$(15)
LOCATE 3, 3
PRINT SPACE$(15)
IF K$ = "S" THEN AD = .1
IF K$ = "D" THEN AD = .2
IF K$ = "C" THEN AD = .3
IF K$ = "H" THEN AD = .4
RETURN

SUB CARDER
CARD(0) = 0
FOR A = 1 TO 4
FOR B = 1 TO 5
IF A <> B THEN
C1 = INT(HAND(A))
C2 = INT(HAND(B))
IF C1 = C2 THEN CARD(0) = 1
END IF
NEXT B
NEXT A
D = 0
D1 = INT(HAND(1))
D2 = INT(HAND(2))
D3 = INT(HAND(3))
D4 = INT(HAND(4))
D5 = INT(HAND(5))
IF D1 = 1 THEN D1 = 14
IF D2 = 1 THEN D2 = 14
IF D3 = 1 THEN D3 = 14
IF D4 = 1 THEN D4 = 14
IF D5 = 1 THEN D5 = 14
HANDE(1) = D1
HANDE(2) = D2
HANDE(3) = D3
HANDE(4) = D4
HANDE(5) = D5
DO UNTIL HANDE(1) >= HANDE(2) AND HANDE(2) >= HANDE(3) AND HANDE(3) >= HANDE(4) AND HANDE(4) >= HANDE(5)
FOR A = 1 TO 4
IF HANDE(A) < HANDE(A + 1) THEN SWAP HANDE(A), HANDE(A + 1)
NEXT A
LOOP
D1 = HANDE(1)
D2 = HANDE(2)
D3 = HANDE(3)
D4 = HANDE(4)
D5 = HANDE(5)
IF D1 = D2 THEN D = D + 1
IF D2 = D3 THEN D = D + 1
IF D3 = D4 THEN D = D + 1
IF D4 = D5 THEN D = D + 1
IF D > 1 THEN CARD(0) = 2
IF D1 = D2 AND D1 = D3 THEN CARD(0) = 3.1
IF D2 = D3 AND D3 = D4 THEN CARD(0) = 3
IF D3 = D4 AND D5 = D3 THEN CARD(0) = 3.3
GF1 = INT(((HAND(1) - INT(HAND(1))) * 10) + .5) / 10
GF2 = INT(((HAND(2) - INT(HAND(2))) * 10) + .5) / 10
GF3 = INT(((HAND(3) - INT(HAND(3))) * 10) + .5) / 10
GF4 = INT(((HAND(4) - INT(HAND(4))) * 10) + .5) / 10
GF5 = INT(((HAND(5) - INT(HAND(5))) * 10) + .5) / 10
IF GF1 = GF2 AND GF2 = GF3 AND GF4 = GF5 AND GF5 = GF3 THEN CARD(0) = 4
IF D5 + 4 = D1 AND D4 + 3 = D1 AND D3 + 2 = D1 AND D2 + 1 = D1 AND CARD(0) = 4 THEN CARD(0) = 8: GOTO SF
IF D5 + 4 = D1 AND D4 + 3 = D1 AND D3 + 2 = D1 AND D2 + 1 = D1 THEN CARD(0) = 5
IF INT(CARD(0)) = 3 THEN
IF CARD(0) = 3.1 AND D4 = D5 THEN CARD(0) = 6
IF CARD(0) = 3.3 AND D1 = D2 THEN CARD(0) = 6
END IF
IF D1 = D2 AND D2 = D3 AND D3 = D4 THEN CARD(0) = 7
IF D2 = D3 AND D3 = D4 AND D4 = D5 THEN CARD(0) = 7
SF:
IF CARD(0) = 8 THEN
IF D1 = 14 THEN CARD(0) = 9
END IF
CARD(0) = INT(CARD(0))
END SUB

SUB DEAL (CARD, XH, YV)
IF CARD = 50 THEN PUT (XH, YV), JOKER, PSET
IF CARD = 0 THEN PUT (XH, YV), TOP, PSET
C = CARD - (INT(CARD))
C = C + .05
C = INT(C * 10)
IF C > 0 THEN
IF C = 1 THEN PUT (XH, YV), SPADE, PSET
IF C = 2 THEN PUT (XH, YV), DIME, PSET
IF C = 3 THEN PUT (XH, YV), CLUB, PSET
IF C = 4 THEN PUT (XH, YV), HEART, PSET
D = 4
IF C = 1 OR C = 3 THEN D = 18
C$ = "  " + STR$(INT(CARD))
IF INT(CARD) = 10 THEN C$ = "  10"
IF INT(CARD) = 1 THEN C$ = " ACE"
IF INT(CARD) = 11 THEN C$ = "   J"
IF INT(CARD) = 12 THEN C$ = "   Q"
IF INT(CARD) = 13 THEN C$ = "   K"
SPRINT C$, XH + 3, YV + 10, D
END IF
END SUB

SUB DISCARDS (ROTATE)
RANDOMIZE TIMER
IF ROTATE <> INT(ROTATE) OR ROTATE = 50 THEN GOTO PILE
IF ROTATE < 1 THEN ROTATE = 1
FOR G = 1 TO ROTATE
FOR H = 1 TO DISCARD(0)
I = INT(RND(1) * DISCARD(0)) + 1
SWAP DISCARD(I), DISCARD(H)
NEXT H
NEXT G
GOTO ENDER
PILE:
DISCARD(0) = DISCARD(0) + 1
DISCARD(DISCARD(0)) = ROTATE
ENDER:
END SUB

SUB DRAWS
CARD(1) = DECK(1)
FOR G = 2 TO 54
DECK(G - 1) = DECK(G)
NEXT G
DECK(54) = 0
END SUB

SUB PURGE
GH = 53
FOR AG = 1 TO 54
IF DECK(AG) = 50 THEN
DECK(AG) = 0
DECK(AG) = DECK(GH)
GH = 54
END IF
NEXT AG
END SUB

SUB RANK
DO UNTIL HAND(1) >= HAND(2) AND HAND(2) >= HAND(3) AND HAND(3) >= HAND(4) AND HAND(4) >= HAND(5)
FOR A = 1 TO 4
IF HAND(A) < HAND(A + 1) THEN SWAP HAND(A), HAND(A + 1)
NEXT A
LOOP
K = 0
IF HAND(1) = 50 THEN
FOR H = 1 TO 13
FOR I = 1 TO 4
FOR G = 1 TO 5
HANDS(G) = HAND(G)
NEXT G
HAND(1) = H + (I / 10)
DO UNTIL HAND(1) >= HAND(2) AND HAND(2) >= HAND(3) AND HAND(3) >= HAND(4) AND HAND(4) >= HAND(5)
FOR A = 1 TO 4
IF HAND(A) < HAND(A + 1) THEN SWAP HAND(A), HAND(A + 1)
NEXT A
LOOP
CARDER
IF CARD(0) > K THEN K = CARD(0)
FOR G = 1 TO 5
HAND(G) = HANDS(G)
NEXT G
NEXT I
NEXT H
HAND(1) = 50
ELSE
CARDER
K = CARD(0)
END IF
CARD(0) = K
END SUB

SUB SHUFFLE (ROTATE)
RANDOMIZE TIMER
FOR G = 0 TO 54
DISCARD(G) = 0
NEXT G
FOR G = 1 TO 13
FOR H = 1 TO 4
DECK(((G - 1) * 4) + H) = G + (H / 10)
NEXT H
NEXT G
DECK(53) = 50
DECK(54) = 50
ROTATE = INT(ROTATE)
IF ROTATE < 1 THEN ROTATE = 1
ROTATE = ROTATE * 54
FOR G = 1 TO ROTATE
ROT = G
DO UNTIL ROT <= 54
ROT = ROT - 54
LOOP
H = INT(RND(1) * 54) + 1
I = DECK(H)
DECK(H) = DECK(ROT)
DECK(ROT) = I
NEXT G
END SUB

SUB SPHERE (SX, SY, SCOLOR, SDIM, SRANGE)
'FEEL FREE TO USE MY SUB IN ANY PROGRAM, JUST LEAVE THIS SCREEN THE WAY IT IS
'          WRITTEN 1996 BY ERIC DAVIDSON

SS = INT(63 / SDIM)    'CALCULATES COLOR STEP
FOR SG = SDIM - 1 TO 1 STEP -1
SV = SRANGE + SG - 1
CIRCLE (SX, SY), SG, SV     'DRAWS THE CIRCLE
PAINT (SX, SY), SV, SV      'FILLS THE CIRCLE
ST = (SDIM * SS) - (SG * SS) + 1     'CALCULATES REVERSE INCRIMENT FOR PALETTE
IF SCOLOR = 1 THEN PALETTE SV, 65536 * ST     'BLUE
IF SCOLOR = 2 THEN PALETTE SV, 65536 * ST + ST     'PURPLE
IF SCOLOR = 3 THEN PALETTE SV, 256 * ST     'GREEN
IF SCOLOR = 4 THEN PALETTE SV, 256 * ST + ST     'YELLOW
IF SCOLOR = 5 THEN PALETTE SV, ST     'RED
IF SCOLOR = 6 THEN PALETTE SV, (65536 * ST) + (256 * ST) + ST     'WHITE
IF SCOLOR = 7 THEN PALETTE SV, (65536 * ST) + (256 * ST)    'LIGHT BLUE (AGUA)
NEXT SG
END SUB

SUB SPRINT (SMT$, HORIZA, VERTICA, COLO)
'FEEL FREE TO USE THIS SUB IN ANY OF YOUR PROGRAMS, JUST LEAVE THIS SCREEN
'THE WAY IT IS...THANKS!
'       ERIC DAVIDSON   1996
STLEN = LEN(SMT$)
FOR SMTDRAW = 1 TO STLEN
SMTNUM = ASC(MID$(SMT$, SMTDRAW, 1))
SMTEST = 0
IF SMTNUM > 48 AND SMTNUM < 58 THEN SMTNUM = SMTNUM - 19: SMTEST = 1
IF SMTNUM = 48 THEN SMTNUM = 39: SMTEST = 1
IF SMTEST = 0 THEN SMTNUM = SMTNUM - 64
IF SMTNUM = -19 THEN SMTNUM = 27
IF SMTNUM = -18 THEN SMTNUM = 28
IF SMTNUM = -22 THEN SMTNUM = 29
FOR SMTLINE = 0 TO 4
IF SMTNUM > 0 AND SMTNUM < 40 THEN
IF SMALLTEXT(SMTNUM, SMTLINE * 4 + 2) <> -1 THEN
SMTC1 = HORIZA + SMALLTEXT(SMTNUM, SMTLINE * 4 + 2)
SMTC2 = VERTICA + SMALLTEXT(SMTNUM, SMTLINE * 4 + 3)
SMTC3 = HORIZA + SMALLTEXT(SMTNUM, SMTLINE * 4 + 4)
SMTC4 = VERTICA + SMALLTEXT(SMTNUM, SMTLINE * 4 + 5)
LINE (SMTC1, SMTC2)-(SMTC3, SMTC4), COLO
END IF
END IF
NEXT SMTLINE
HORIZA = HORIZA + 2
IF SMTNUM > 0 AND SMTNUM < 40 THEN HORIZA = HORIZA + SMALLTEXT(SMTNUM, 1)
NEXT SMTDRAW
END SUB

