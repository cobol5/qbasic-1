DECLARE SUB LOADILI4P (ILI$, PALETTE$)
DECLARE SUB LOADPAL2 (PAL$, IR!, IG!, IB!, DNCC0!)
DECLARE SUB LOADPALS (PAL$, SCALE$)
DECLARE SUB LOADQSI (QSINAME$, PAL$, XPOS!, YPOS!)
DECLARE SUB LOADPAL (PAL$)
DECLARE SUB LOADILI4 (ILI$)
DECLARE SUB LOADILI (ILI$, XPOS, YPOS)
CLS : SCREEN 13
SHELL "CD ILI"
DIM SHARED IMAGE(1 TO 16350)
LOADILI4P "HORIZON", "HORIZON"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "H2", "H2"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "H3", "H3"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPAL "TWOLF"
LOADILI4 "SC1"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4 "SC2"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4 "SC3"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPALS "TWOLF", "GREY"
LOADILI4 "SC4"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPALS "TWOLF", "RED"
LOADILI4 "SC5"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPAL2 "TWOLF", -20, -20, -20, 1
LOADQSI "TWOLF", "N", 0, 0
FOR I = -10 TO 10
LOADPAL2 "TWOLF", I, I, I, 1
NEXT I
LOADPAL "TWOLF"
LOADQSI "TEXT7", "N", 150, 0
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "TIE", "TIE"
SHELL "CD.."
SHELL "CD ANIM1"
R1 = TIMER
FOR I = 0 TO 100
NUM$ = STR$(I)
NUM$ = LTRIM$(NUM$)
NUM$ = RTRIM$(NUM$)
FLNM2$ = "TIE" + NUM$ + ".ILI"
LOADILI FLNM2$, 0, 0
NEXT I
SHELL "CD.."
SHELL "CD ILI"
R2 = TIMER
R3 = R2 - R1
R4 = 100 / R3
COLOR 255
LOCATE 1, 9: PRINT "TIME TAKEN:"; R3
LOCATE 2, 9: PRINT ; "FRAMES: 100"
LOCATE 3, 9: PRINT ; "FPS:"; R4
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPAL "I2"
LOADILI4 "SC6"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPAL "I2"
LOADILI4 "SC7"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPAL "I1"
LOADILI4 "SC8"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPAL "I3"
LOADILI4 "SC9"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPAL "GAME"
LOADILI4 "SC10"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADPAL "CASTLE"
LOADILI4 "SC11"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "SC12", "E2"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "SC13", "E4"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "SC14", "E5"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "SC15", "LADY"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "SC16", "KNIGHT"
DO: LOOP UNTIL INKEY$ <> ""
CLS
LOADILI4P "SC17", "LJS"
DO: LOOP UNTIL INKEY$ <> ""
SHELL "CD.."
CLS
PRINT "YOUR MISSING A GREAT ANIMATION!"
SLEEP 2
SYSTEM

'COPYWRITE 1997 HORIZON SOFTWARE
SUB LOADILI (ILI$, XPOS, YPOS)
IF INSTR(ILI$, ".") = 0 THEN ILI$ = ILI$ + ".ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI$, VARPTR(IMAGE(1))
PUT (XPOS, YPOS), IMAGE, PSET
END SUB

'COPYWRITE 1997 HORIZON SOFTWARE
SUB LOADILI4 (ILI$)
X = 0
Y = 0
ILI1$ = ILI$ + "1.ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI1$, VARPTR(IMAGE(1))
PUT (X, Y), IMAGE, PSET
X = 160
Y = 0
ILI2$ = ILI$ + "2.ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI2$, VARPTR(IMAGE(1))
PUT (X, Y), IMAGE, PSET
X = 0
Y = 100
ILI3$ = ILI$ + "3.ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI3$, VARPTR(IMAGE(1))
PUT (X, Y), IMAGE, PSET
X = 160
Y = 100
ILI4$ = ILI$ + "4.ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI4$, VARPTR(IMAGE(1))
PUT (X, Y), IMAGE, PSET
END SUB

'COPYWRITE 1997 HORIZON SOFTWARE
SUB LOADILI4P (ILI$, PALETTE$)
LOADPAL PALETTE$
X = 0
Y = 0
ILI1$ = ILI$ + "1.ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI1$, VARPTR(IMAGE(1))
PUT (X, Y), IMAGE, PSET
X = 160
Y = 0
ILI2$ = ILI$ + "2.ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI2$, VARPTR(IMAGE(1))
PUT (X, Y), IMAGE, PSET
X = 0
Y = 100
ILI3$ = ILI$ + "3.ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI3$, VARPTR(IMAGE(1))
PUT (X, Y), IMAGE, PSET
X = 160
Y = 100
ILI4$ = ILI$ + "4.ILI"
DEF SEG = VARSEG(IMAGE(1))
BLOAD ILI4$, VARPTR(IMAGE(1))
PUT (X, Y), IMAGE, PSET
END SUB

'COPYWRITE 1997 HORIZON SOFTWARE
SUB LOADPAL (PAL$)
IF INSTR(PAL$, ".") = 0 THEN PAL$ = PAL$ + ".PAL"
DIM RED AS STRING * 1
DIM GREEN AS STRING * 1
DIM BLUE AS STRING * 1
DIM PARRAY&(255)
OPEN PAL$ FOR BINARY AS #1
FOR I = 0 TO 255
  GET #1, , RED
  GET #1, , GREEN
  GET #1, , BLUE
  R% = ASC(RED)
  G% = ASC(GREEN)
  B% = ASC(BLUE)
  PARRAY&(I) = 65536 * B% + 256 * G% + R%
NEXT I
PALETTE USING PARRAY&(0)
CLOSE
END SUB

'COPYWRITE 1997 HORIZON SOFTWARE
SUB LOADPAL2 (PAL$, IR, IG, IB, DNCC0)
IF INSTR(PAL$, ".") = 0 THEN PAL$ = PAL$ + ".PAL"
DIM RED AS STRING * 1
DIM GREEN AS STRING * 1
DIM BLUE AS STRING * 1
DIM PARRAY&(255)
OPEN PAL$ FOR BINARY AS #1
FOR I = 0 TO 255
  GET #1, , RED
  GET #1, , GREEN
  GET #1, , BLUE
  R% = ASC(RED)
  G% = ASC(GREEN)
  B% = ASC(BLUE)
  R% = R% + IR
  G% = G% + IG
  B% = B% + IB
  IF R% > 63 THEN R% = 63
  IF G% > 63 THEN G% = 63
  IF B% > 63 THEN B% = 63
  IF R% < 0 THEN R% = 0
  IF G% < 0 THEN G% = 0
  IF B% < 0 THEN B% = 0
  IF DNCC0 = 1 AND I = 0 THEN R% = 0: G% = 0: B% = 0
  PARRAY&(I) = 65536 * B% + 256 * G% + R%
NEXT I
PALETTE USING PARRAY&(0)
CLOSE
END SUB

'COPYWRITE 1997 HORIZON SOFTWARE
SUB LOADPALS (PAL$, SCALE$)
IF INSTR(PAL$, ".") = 0 THEN PAL$ = PAL$ + ".PAL"
DIM RED AS STRING * 1
DIM GREEN AS STRING * 1
DIM BLUE AS STRING * 1
DIM PARRAY&(255)
OPEN PAL$ FOR BINARY AS #1
FOR I = 0 TO 255
  GET #1, , RED
  GET #1, , GREEN
  GET #1, , BLUE
  R% = ASC(RED)
  G% = ASC(GREEN)
  B% = ASC(BLUE)
I% = (R% + G% + B%) / 3
IF SCALE$ = "GREY" THEN R% = I%: G% = I%: B% = I%
IF SCALE$ = "BLUE" THEN R% = 0: G% = 0: B% = I%
IF SCALE$ = "GREEN" THEN R% = 0: G% = I%: B% = 0
IF SCALE$ = "RED" THEN R% = I%: G% = 0: B% = 0
IF SCALE$ = "PURPLE" THEN R% = I%: G% = 0: B% = I%
IF SCALE$ = "YELLOW" THEN R% = 0: G% = I%: B% = I%
IF SCALE$ = "WIERD" THEN
        RANDOMIZE TIMER
        LET A = INT(RND(1) * 30 + 1)
        LET B = INT(RND(1) * 30 + 1)
        LET C = INT(RND(1) * 30 + 1)
        R% = I% - A: G% = I% - B: B% = I% - C
END IF
IF SCALE$ = "WIERD2" THEN R% = I%: G% = I%: B% = I% - 20
IF SCALE$ = "BW" THEN
        IF I% >= 32 THEN R% = 63: G% = 63: B% = 63 ELSE R% = 0: G% = 0: B% = 0
END IF
IF R% > 63 THEN R% = 63
IF G% > 63 THEN G% = 63
IF B% > 63 THEN B% = 63
IF R% < 0 THEN R% = 0
IF G% < 0 THEN G% = 0
IF B% < 0 THEN B% = 0
  PARRAY&(I) = 65536 * B% + 256 * G% + R%
NEXT I
PALETTE USING PARRAY&(0)
CLOSE
END SUB

'COPYWRITE 1997 HORIZON SOFTWARE
SUB LOADQSI (QSINAME$, PAL$, XPOS, YPOS)
DIM XB AS STRING * 1
DIM YB AS STRING * 1
DIM XM AS STRING * 1
DIM YM AS STRING * 1
DIM PB AS STRING * 1
DIM RED AS STRING * 1
DIM GREEN AS STRING * 1
DIM BLUE AS STRING * 1
DIM BYTE AS STRING * 1
DIM PARRAY&(255)
IF INSTR(QSINAME$, ".") = 0 THEN QSN$ = QSINAME$ + ".QSI" ELSE QSN$ = QSINAME$
   OPEN QSN$ FOR BINARY AS #1
      IF LOF(1) = 0 THEN PRINT "FILE NOT FOUND": CLOSE #1: KILL QSN$: GOTO ENDC
      GET #1, 1, XB
      GET #1, 2, YB
      GET #1, 3, XM
      GET #1, 4, YM
      GET #1, 5, PB
      XSIZE = ASC(XB) * ASC(XM)
      YSIZE = ASC(YB) * ASC(YM)
      PBC% = ASC(PB)
      PAL$ = UCASE$(PAL$)
        IF PAL$ <> "NO" AND PAL$ <> "N" THEN
         SEEK #1, 10
          FOR I = 0 TO 255
            GET #1, , RED
            GET #1, , GREEN
            GET #1, , BLUE
            R% = ASC(RED)
            G% = ASC(GREEN)
            B% = ASC(BLUE)
            PARRAY&(I) = 65536 * B% + 256 * G% + R%
          NEXT I
          PALETTE USING PARRAY&(0)
          END IF
          SEEK #1, 800
          FOR Y = YPOS TO YSIZE + YPOS
          FOR X = XPOS TO XSIZE + XPOS
             GET #1, , BYTE
             C = ASC(BYTE)
             PSET (X, Y), C
           NEXT X
          NEXT Y
ENDC:
CLOSE
END SUB

